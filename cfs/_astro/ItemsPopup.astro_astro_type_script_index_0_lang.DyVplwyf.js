import{g as m,a as D,i as H,r as R,b as z}from"./local-storage.BX_TrTX5.js";import{g as F}from"./plan-helper.C8iL4cXF.js";const c=document.getElementById("expandButton"),g=document.querySelector(".cards-container"),C=c?c.querySelector(".show-text"):null,L=c?c.querySelector(".hide-text"):null,q=c?c.querySelector(".arrow"):null;let I=!1,b=!0,V=!0;const y=()=>{if(!b||I)g.classList.remove("fade-active"),g.classList.add("fade-hidden"),C.style.display="none",L.style.display="inline",q.style.transform="rotate(180deg)";else if(g.classList.remove("fade-hidden"),g.classList.add("fade-active"),C.style.display="inline",L.style.display="none",q.style.transform="rotate(0deg)",!V){const t=document.getElementById("items");if(t){const o=t.getBoundingClientRect().top+window.pageYOffset+-20;window.scrollTo({top:o,behavior:"smooth"})}}};c&&c.addEventListener("click",()=>{I=!I,V=!1,y()});const A=e=>e.filter(t=>!t.classList.contains("package-exclusive-item")),G=e=>{const t=document.querySelector(".cards-grid");if(!t)return;const n=Array.from(t.querySelectorAll(".card"));let o=A(n).length;if(e==="all")n.sort((i,s)=>{const r=parseInt(i.getAttribute("data-order")||"0"),a=parseInt(s.getAttribute("data-order")||"0");return r-a});else{let i="data-order";e==="talent_recruitment"?i="data-talent-recruitment-order":e==="brand_exposure"?i="data-brand-exposure-order":e==="product_promotion"&&(i="data-product-promotion-order"),n.sort((s,r)=>{const a=parseInt(s.getAttribute(i)||"999999"),d=parseInt(r.getAttribute(i)||"999999");return a-d})}n.forEach(i=>{Y(i,e)}),n.forEach(i=>t.appendChild(i)),B(o)},J=()=>{const e=window.innerWidth;return e<=768?2:e<=1024?4:6},Y=(e,t)=>{const n=e.querySelector(".description");if(!n)return;const o=e.getAttribute("data-descriptions");if(o)try{const i=JSON.parse(o),s=i[t]||i.all||"";n.textContent=s}catch{}},B=e=>{const t=document.getElementById("expandButton");if(!t)return;const n=J();e>n?(b=!0,t.style.display="flex",y()):(b=!1,t.style.display="none",y())},P=document.querySelectorAll(".tab");P.forEach(e=>{e.addEventListener("click",()=>{const t=e;P.forEach(o=>o.classList.remove("active")),t.classList.add("active");const n=t.getAttribute("data-category")||"all";G(n)})});const j=A(Array.from(document.querySelectorAll(".card"))).length;B(j);y();window.addEventListener("resize",()=>{const e=A(Array.from(document.querySelectorAll(".card")));B(e.length)});const N=()=>{const e=m(),t=new Set(e.map(n=>n.id));document.querySelectorAll(".add-button").forEach(n=>{const o=n.getAttribute("data-item-id")||"",i=n.getAttribute("data-item-deadline")||"";D(i)?(n.setAttribute("disabled","true"),n.classList.add("disabled")):(n.removeAttribute("disabled"),n.classList.remove("disabled"));let r=t.has(o);if(!r){for(const a of t)if(a.startsWith(o+"-sub-")){r=!0;break}}r?n.classList.add("added"):n.classList.remove("added")})},K=()=>{document.querySelectorAll(".card").forEach(t=>{const n=t.getAttribute("data-card-id");n&&(t.style.cursor="pointer",t.addEventListener("click",o=>{if(o.target.closest(".add-button"))return;o.stopPropagation();const s=`item-popup-${n}`;window.popupCtrl(s,"open")}))})},x=()=>{document.querySelectorAll(".card").forEach(t=>{const n=t.getAttribute("data-card-id");n&&(H(n)?t.classList.add("highlighted"):t.classList.remove("highlighted"))})},M=()=>{const e=m(),t=document.querySelector(".interest-count");t&&(e.length>0?t.textContent=e.length.toString():t.textContent="")},O=()=>{const e=m(),t=document.getElementById("interestItemsList");if(!t)return;if(e.length===0){t.innerHTML=`<div class="empty-state">${document.querySelector("[data-i18n-no-items]")?.textContent}</div>`;return}t.innerHTML="";const n=document.getElementById("removeIconTemplate");e.forEach(i=>{const s=document.createElement("div");s.className="interest-item",s.setAttribute("data-item-id",i.id);const r=document.createElement("div");r.className="item-content";const a=document.createElement("span");a.className="item-title",a.textContent=i.title;const d=document.createElement("button");if(d.className="remove-item",d.setAttribute("data-item-id",i.id),n){const f=n.content.cloneNode(!0);d.appendChild(f)}r.appendChild(a),r.appendChild(d),s.appendChild(r),t.appendChild(s)}),t.querySelectorAll(".remove-item").forEach(i=>{i.addEventListener("click",s=>{s.stopPropagation();const r=i.getAttribute("data-item-id")||"";R(r)})})};let v=m().length;window.addEventListener("itemsChange",e=>{M(),O(),x();let t=v;try{const n=e;n?.detail&&Array.isArray(n.detail.items)?t=n.detail.items.length:t=m().length}catch{t=m().length}t>v&&setTimeout(()=>U(),0),v=t});const w=document.getElementById("interestButton"),l=document.getElementById("interestPopover"),U=()=>{l&&(O(),l.classList.add("active"))},u=()=>{l&&l.classList.remove("active")};w&&w.addEventListener("click",e=>{e.stopPropagation(),l?.classList.contains("active")?u():U()});document.addEventListener("click",e=>{const t=e.target;if(!(t instanceof Element))return;const n=t.closest(".add-button");if(n){e.preventDefault(),e.stopPropagation();const o=n.getAttribute("data-item-id")||"",i=n.getAttribute("data-item-deadline")||"";if(D(i))return;const s=n.closest(".card");if(s?.getAttribute("data-has-sub-items")==="true"){const a=`item-popup-${o}`;window.popupCtrl(a,"open")}else{const a=n.getAttribute("data-item-title")||"",d=n.getAttribute("data-item-image")||"",f=n.getAttribute("data-item-price")||"";if(H(o))R(o);else{const W=s?.querySelector(".deadline-tag")?.textContent||"",$=F(o,f);z({id:o,title:a,category:"all",image:d,deadline:W,price:$})}}return}if(l?.classList.contains("active")&&!l.contains(e.target)&&!w?.contains(e.target)){u();return}if(t.closest(".download-quote-btn")){e.preventDefault();const o=window.location.origin+"/2026/cfs/quotation";window.open(o,"_blank"),u();return}if(t.closest(".view-plan-btn")){if(e.preventDefault(),p){const o=document.getElementById("form");o&&(o.scrollIntoView({behavior:"smooth"}),u())}else{const o=document.getElementById("plans");o&&(o.scrollIntoView({behavior:"smooth"}),u(),p=!0,_())}return}});document.addEventListener("keydown",e=>{e.key==="Escape"&&u()});M();N();const h=["items","plans","addons","form"];let T="",p=!1,k=!1;const Q=document.getElementById("viewPlanBtnText")?.textContent||"檢視方案詳情",X="聯絡我們",_=()=>{const e=document.getElementById("viewPlanBtnText");e&&(p?e.textContent=X:e.textContent=Q)},S=()=>{const e=document.querySelectorAll(".interest-button");let t=!1,n="";for(const s of h){const r=document.getElementById(s);if(r){const a=r.getBoundingClientRect(),d=a.height;if(Math.min(a.bottom,window.innerHeight)-Math.max(a.top,0)>d*.3){n=s;break}}}n&&n!==T&&(T=n,n==="plans"&&!p&&(p=!0,_()));const o=document.getElementById(h[0]),i=document.getElementById(h[h.length-1]);if(o&&i){const s=o.getBoundingClientRect(),r=i.getBoundingClientRect(),a=window.innerHeight;t=s.top<a&&r.bottom>0}t!==k&&(k=t,e.forEach(s=>{const r=s;r.style.display=t?"flex":"none"}))};let E;const Z=()=>{E&&cancelAnimationFrame(E),E=requestAnimationFrame(S)};document.addEventListener("scroll",Z);window.addEventListener("resize",S);setTimeout(S,100);window.addEventListener("itemsChange",N);document.addEventListener("interested-items-changed",x);K();x();
