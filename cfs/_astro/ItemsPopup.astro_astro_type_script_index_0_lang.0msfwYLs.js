import{g as m,r as O,i as U}from"./local-storage.BX_TrTX5.js";import{i as _,u as z}from"./add-to-cart-handler.L6PMBq8p.js";import"./plan-helper.C8iL4cXF.js";document.addEventListener("DOMContentLoaded",function(){_({onCardClick:t=>{const e=`item-popup-${t}`;window.popupCtrl(e,"open")}})});const d=document.getElementById("expandButton"),f=document.querySelector(".cards-container"),A=d?d.querySelector(".show-text"):null,S=d?d.querySelector(".hide-text"):null,q=d?d.querySelector(".arrow"):null;let E=!1,w=!0,D=!0;const h=()=>{if(!w||E)f.classList.remove("fade-active"),f.classList.add("fade-hidden"),A.style.display="none",S.style.display="inline",q.style.transform="rotate(180deg)";else if(f.classList.remove("fade-hidden"),f.classList.add("fade-active"),A.style.display="inline",S.style.display="none",q.style.transform="rotate(0deg)",!D){const e=document.getElementById("items");if(e){const a=e.getBoundingClientRect().top+window.pageYOffset+-20;window.scrollTo({top:a,behavior:"smooth"})}}};d&&d.addEventListener("click",()=>{E=!E,D=!1,h()});const I=t=>t.filter(e=>!e.classList.contains("package-exclusive-item")),F=t=>{const e=document.querySelector(".cards-grid");if(!e)return;const n=Array.from(e.querySelectorAll(".card"));let a=I(n).length;if(t==="all")n.sort((o,i)=>{const s=parseInt(o.getAttribute("data-order")||"0"),r=parseInt(i.getAttribute("data-order")||"0");return s-r});else{let o="data-order";t==="talent_recruitment"?o="data-talent-recruitment-order":t==="brand_exposure"?o="data-brand-exposure-order":t==="product_promotion"&&(o="data-product-promotion-order"),n.sort((i,s)=>{const r=parseInt(i.getAttribute(o)||"999999"),c=parseInt(s.getAttribute(o)||"999999");return r-c})}n.forEach(o=>{$(o,t)}),n.forEach(o=>e.appendChild(o)),x(a)},W=()=>{const t=window.innerWidth;return t<=768?2:t<=1024?4:6},$=(t,e)=>{const n=t.querySelector(".description");if(!n)return;const a=t.getAttribute("data-descriptions");if(a)try{const o=JSON.parse(a),i=o[e]||o.all||"";n.textContent=i}catch{}},x=t=>{const e=document.getElementById("expandButton");if(!e)return;const n=W();t>n?(w=!0,e.style.display="flex",h()):(w=!1,e.style.display="none",h())},T=document.querySelectorAll(".tab");T.forEach(t=>{t.addEventListener("click",()=>{const e=t;T.forEach(a=>a.classList.remove("active")),e.classList.add("active");const n=e.getAttribute("data-category")||"all";F(n)})});const G=I(Array.from(document.querySelectorAll(".card"))).length;x(G);h();window.addEventListener("resize",()=>{const t=I(Array.from(document.querySelectorAll(".card")));x(t.length)});const H=z,C=()=>{document.querySelectorAll(".card").forEach(e=>{const n=e.getAttribute("data-card-id");n&&(U(n)?e.classList.add("highlighted"):e.classList.remove("highlighted"))})},R=()=>{const t=m(),e=document.querySelector(".interest-count");e&&(t.length>0?e.textContent=t.length.toString():e.textContent="")},V=()=>{const t=m(),e=document.getElementById("interestItemsList");if(!e)return;if(t.length===0){e.innerHTML=`<div class="empty-state">${document.querySelector("[data-i18n-no-items]")?.textContent}</div>`;return}e.innerHTML="";const n=document.getElementById("removeIconTemplate");t.forEach(o=>{const i=document.createElement("div");i.className="interest-item",i.setAttribute("data-item-id",o.id);const s=document.createElement("div");s.className="item-content";const r=document.createElement("span");r.className="item-title",r.textContent=o.title;const c=document.createElement("button");if(c.className="remove-item",c.setAttribute("data-item-id",o.id),n){const L=n.content.cloneNode(!0);c.appendChild(L)}s.appendChild(r),s.appendChild(c),i.appendChild(s),e.appendChild(i)}),e.querySelectorAll(".remove-item").forEach(o=>{o.addEventListener("click",i=>{i.stopPropagation();const s=o.getAttribute("data-item-id")||"";O(s)})})};let v=m().length;window.addEventListener("itemsChange",t=>{R(),V(),C();let e=v;try{const n=t;n?.detail&&Array.isArray(n.detail.items)?e=n.detail.items.length:e=m().length}catch{e=m().length}e>v&&setTimeout(()=>N(),0),v=e});const B=document.getElementById("interestButton"),l=document.getElementById("interestPopover"),N=()=>{l&&(V(),l.classList.add("active"))},u=()=>{l&&l.classList.remove("active")};B&&B.addEventListener("click",t=>{t.stopPropagation(),l?.classList.contains("active")?u():N()});document.addEventListener("click",t=>{const e=t.target;if(e instanceof Element){if(l?.classList.contains("active")&&!l.contains(t.target)&&!B?.contains(t.target)){u();return}if(e.closest(".download-quote-btn")){t.preventDefault();const n=window.location.origin+"/2026/cfs/quotation";window.open(n,"_blank"),u();return}if(e.closest(".view-plan-btn")){if(t.preventDefault(),p){const n=document.getElementById("form");n&&(n.scrollIntoView({behavior:"smooth"}),u())}else{const n=document.getElementById("plans");n&&(n.scrollIntoView({behavior:"smooth"}),u(),p=!0,M())}return}}});document.addEventListener("keydown",t=>{t.key==="Escape"&&u()});R();H();const g=["items","plans","addons","form"];let P="",p=!1,k=!1;const J=document.getElementById("viewPlanBtnText")?.textContent||"檢視方案詳情",Y="聯絡我們",M=()=>{const t=document.getElementById("viewPlanBtnText");t&&(p?t.textContent=Y:t.textContent=J)},b=()=>{const t=document.querySelectorAll(".interest-button");let e=!1,n="";for(const i of g){const s=document.getElementById(i);if(s){const r=s.getBoundingClientRect(),c=r.height;if(Math.min(r.bottom,window.innerHeight)-Math.max(r.top,0)>c*.3){n=i;break}}}n&&n!==P&&(P=n,n==="plans"&&!p&&(p=!0,M()));const a=document.getElementById(g[0]),o=document.getElementById(g[g.length-1]);if(a&&o){const i=a.getBoundingClientRect(),s=o.getBoundingClientRect(),r=window.innerHeight;e=i.top<r&&s.bottom>0}e!==k&&(k=e,t.forEach(i=>{const s=i;s.style.display=e?"flex":"none"}))};let y;const j=()=>{y&&cancelAnimationFrame(y),y=requestAnimationFrame(b)};document.addEventListener("scroll",j);window.addEventListener("resize",b);setTimeout(b,100);window.addEventListener("itemsChange",H);document.addEventListener("interested-items-changed",C);C();
