import{g as M}from"./local-storage.CNRxCPsY.js";const b="https://docs.google.com/forms/d/e/1FAIpQLSftAam5nJJQU925yOzuMoome-XY3MEs7idtbd56eqMDRrPKGw/formResponse",n=document.getElementById("sponsor-form"),s=document.getElementById("submit"),o=document.getElementById("form-message");if(!n||!s||!o)console.warn("Sponsor form elements are missing.");else{let m=function(){const e=M();return e.length===0?"":`感興趣的項目：${e.map(t=>t.quantity&&t.quantity>1?`${t.title} ${t.quantity} 份`:t.title).join("、")}`};const c=n.dataset.requiredMessage??"請確認必填欄位",u=n.dataset.leadingEqualMessage??"回答的第一個字不可是=",d=n.dataset.successMessage??"已送出成功！感謝您的填寫",g=n.dataset.errorMessage??"發生錯誤，請稍後再試",l=s.dataset.defaultText??s.textContent??"",f=s.dataset.loadingText??"送出中…",y={organization:"entry.1867519928",department:"entry.363990418",name:"entry.1660888396",contact:"entry.1209239304",message:"entry.65159086"},p=()=>{const e=new FormData(n);if(!e.get("organization")||!e.get("name")||!e.get("contact"))return o.textContent=c,!1;for(const[r,t]of e.entries())if(typeof t=="string"&&t.startsWith("="))return o.textContent=u,!1;return o.textContent="",!0};n.addEventListener("submit",e=>{if(e.preventDefault(),!p())return;s.disabled=!0,s.textContent=f;const r=new FormData;Object.entries(y).forEach(([t,x])=>{let a=n.querySelector(`[name="${t}"]`)?.value??"";if(t==="message"){const i=m();i&&(a=a.trim()?`${a}

${i}`:i)}r.append(x,a)}),fetch(b,{method:"POST",mode:"no-cors",body:r}).then(()=>{n.reset(),o.textContent=d}).catch(t=>{console.error("Form submit error:",t),o.textContent=g}).finally(()=>{s.disabled=!1,s.textContent=l})})}
