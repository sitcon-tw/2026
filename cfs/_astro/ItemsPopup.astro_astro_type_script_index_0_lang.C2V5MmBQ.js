import{g as m,r as _,i as z,a as F}from"./local-storage.BX_TrTX5.js";import{i as W,u as $}from"./add-to-cart-handler.CNdPvhIr.js";import"./plan-helper.GKC8TKHI.js";document.addEventListener("DOMContentLoaded",function(){W({onCardClick:t=>{const e=`item-popup-${t}`;window.popupCtrl(e,"open")}})});const d=document.getElementById("expandButton"),g=document.querySelector(".cards-container"),S=d?d.querySelector(".show-text"):null,A=d?d.querySelector(".hide-text"):null,q=d?d.querySelector(".arrow"):null;let w=!1,B=!0,H=!0;const v=()=>{if(!B||w)g.classList.remove("fade-active"),g.classList.add("fade-hidden"),S.style.display="none",A.style.display="inline",q.style.transform="rotate(180deg)";else if(g.classList.remove("fade-hidden"),g.classList.add("fade-active"),S.style.display="inline",A.style.display="none",q.style.transform="rotate(0deg)",!H){const e=document.getElementById("items");if(e){const r=e.getBoundingClientRect().top+window.pageYOffset+-20;window.scrollTo({top:r,behavior:"smooth"})}}};d&&d.addEventListener("click",()=>{w=!w,H=!1,v()});const x=t=>t.filter(e=>!e.classList.contains("package-exclusive-item")),T=t=>{const e=t.getAttribute("data-is-sold-out")==="true",n=t.getAttribute("data-deadline")||"";return e||F(n)},G=t=>{const e=document.querySelector(".cards-grid");if(!e)return;const n=Array.from(e.querySelectorAll(".card"));let r=x(n).length,i="data-order";t==="talent_recruitment"?i="data-talent-recruitment-order":t==="brand_exposure"?i="data-brand-exposure-order":t==="product_promotion"&&(i="data-product-promotion-order"),n.sort((o,s)=>{const a=T(o),c=T(s);if(a&&!c)return 1;if(!a&&c)return-1;const f=parseInt(o.getAttribute(i)||(t==="all"?"0":"999999")),U=parseInt(s.getAttribute(i)||(t==="all"?"0":"999999"));return f-U}),n.forEach(o=>{Y(o,t)}),n.forEach(o=>e.appendChild(o)),C(r)},J=()=>{const t=window.innerWidth;return t<=768?2:t<=1024?4:6},Y=(t,e)=>{const n=t.querySelector(".description");if(!n)return;const r=t.getAttribute("data-descriptions");if(r)try{const i=JSON.parse(r),o=i[e]||i.all||"";n.textContent=o}catch{}},C=t=>{const e=document.getElementById("expandButton");if(!e)return;const n=J();t>n?(B=!0,e.style.display="flex",v()):(B=!1,e.style.display="none",v())},P=document.querySelectorAll(".tab");P.forEach(t=>{t.addEventListener("click",()=>{const e=t;P.forEach(r=>r.classList.remove("active")),e.classList.add("active");const n=e.getAttribute("data-category")||"all";G(n)})});const j=x(Array.from(document.querySelectorAll(".card"))).length;C(j);v();window.addEventListener("resize",()=>{const t=x(Array.from(document.querySelectorAll(".card")));C(t.length)});const R=$,b=()=>{document.querySelectorAll(".card").forEach(e=>{const n=e.getAttribute("data-card-id");n&&(z(n)?e.classList.add("highlighted"):e.classList.remove("highlighted"))})},V=()=>{const t=m(),e=document.querySelector(".interest-count");e&&(t.length>0?e.textContent=t.length.toString():e.textContent="")},N=()=>{const t=m(),e=document.getElementById("interestItemsList");if(!e)return;if(t.length===0){e.innerHTML=`<div class="empty-state">${document.querySelector("[data-i18n-no-items]")?.textContent}</div>`;return}e.innerHTML="";const n=document.getElementById("removeIconTemplate");t.forEach(i=>{const o=document.createElement("div");o.className="interest-item",o.setAttribute("data-item-id",i.id);const s=document.createElement("div");s.className="item-content";const a=document.createElement("span");a.className="item-title",a.textContent=i.title;const c=document.createElement("button");if(c.className="remove-item",c.setAttribute("data-item-id",i.id),n){const f=n.content.cloneNode(!0);c.appendChild(f)}s.appendChild(a),s.appendChild(c),o.appendChild(s),e.appendChild(o)}),e.querySelectorAll(".remove-item").forEach(i=>{i.addEventListener("click",o=>{o.stopPropagation();const s=i.getAttribute("data-item-id")||"";_(s)})})};let y=m().length;window.addEventListener("itemsChange",t=>{V(),N(),b();let e=y;try{const n=t;n?.detail&&Array.isArray(n.detail.items)?e=n.detail.items.length:e=m().length}catch{e=m().length}e>y&&setTimeout(()=>O(),0),y=e});const I=document.getElementById("interestButton"),l=document.getElementById("interestPopover"),O=()=>{l&&(N(),l.classList.add("active"))},u=()=>{l&&l.classList.remove("active")};I&&I.addEventListener("click",t=>{t.stopPropagation(),l?.classList.contains("active")?u():O()});document.addEventListener("click",t=>{const e=t.target;if(e instanceof Element){if(l?.classList.contains("active")&&!l.contains(t.target)&&!I?.contains(t.target)){u();return}if(e.closest(".download-quote-btn")){t.preventDefault();const n=window.location.origin+"/2026/cfs/quotation";window.open(n,"_blank"),u();return}if(e.closest(".view-plan-btn")){if(t.preventDefault(),p){const n=document.getElementById("form");n&&(n.scrollIntoView({behavior:"smooth"}),u())}else{const n=document.getElementById("plans");n&&(n.scrollIntoView({behavior:"smooth"}),u(),p=!0,M())}return}}});document.addEventListener("keydown",t=>{t.key==="Escape"&&u()});V();R();const h=["items","plans","addons","form"];let k="",p=!1,D=!1;const K=document.getElementById("viewPlanBtnText")?.textContent||"檢視方案詳情",Q="聯絡我們",M=()=>{const t=document.getElementById("viewPlanBtnText");t&&(p?t.textContent=Q:t.textContent=K)},L=()=>{const t=document.querySelectorAll(".interest-button");let e=!1,n="";for(const o of h){const s=document.getElementById(o);if(s){const a=s.getBoundingClientRect(),c=a.height;if(Math.min(a.bottom,window.innerHeight)-Math.max(a.top,0)>c*.3){n=o;break}}}n&&n!==k&&(k=n,n==="plans"&&!p&&(p=!0,M()));const r=document.getElementById(h[0]),i=document.getElementById(h[h.length-1]);if(r&&i){const o=r.getBoundingClientRect(),s=i.getBoundingClientRect(),a=window.innerHeight;e=o.top<a&&s.bottom>0}e!==D&&(D=e,t.forEach(o=>{const s=o;s.style.display=e?"flex":"none"}))};let E;const X=()=>{E&&cancelAnimationFrame(E),E=requestAnimationFrame(L)};document.addEventListener("scroll",X);window.addEventListener("resize",L);setTimeout(L,100);window.addEventListener("itemsChange",R);document.addEventListener("interested-items-changed",b);b();
