import{g as h}from"./local-storage.BX_TrTX5.js";const v="https://docs.google.com/forms/d/e/1FAIpQLSftAam5nJJQU925yOzuMoome-XY3MEs7idtbd56eqMDRrPKGw/formResponse",n=document.getElementById("sponsor-form"),s=document.getElementById("submit"),r=document.getElementById("form-message");if(!n||!s||!r)console.warn("Sponsor form elements are missing.");else{let m=function(){const e=h();return e.length===0?"":`感興趣的項目：${e.map(c=>c.title).join("、")}`},i=function(){if(!o)return;const e=m();e?o.value=a.trim()?`${a}

${e}`:e:o.value=a};const d=n.dataset.requiredMessage??"請確認必填欄位",l=n.dataset.leadingEqualMessage??"回答的第一個字不可是=",u=n.dataset.successMessage??"已送出成功！感謝您的填寫",g=n.dataset.errorMessage??"發生錯誤，請稍後再試",f=s.dataset.defaultText??s.textContent??"",p=s.dataset.loadingText??"送出中…",y={organization:"entry.1867519928",department:"entry.363990418",name:"entry.1660888396",contact:"entry.1209239304",message:"entry.65159086"},o=n.querySelector('[name="message"]');let a="";o&&(o.addEventListener("input",()=>{const e=o.value,t=m();t&&e.includes(t)?a=e.replace(`

${t}`,"").replace(t,"").trim():a=e}),i(),window.addEventListener("itemsChange",()=>{i()}));const M=()=>{const e=new FormData(n);if(!e.get("organization")||!e.get("name")||!e.get("contact"))return r.textContent=d,!1;for(const[,t]of e.entries())if(typeof t=="string"&&t.startsWith("="))return r.textContent=l,!1;return r.textContent="",!0};n.addEventListener("submit",e=>{if(e.preventDefault(),!M())return;s.disabled=!0,s.textContent=p;const t=new FormData;Object.entries(y).forEach(([c,x])=>{const E=n.querySelector(`[name="${c}"]`)?.value??"";t.append(x,E)}),fetch(v,{method:"POST",mode:"no-cors",body:t}).then(()=>{n.reset(),a="",i(),r.textContent=u}).catch(c=>{console.error("Form submit error:",c),r.textContent=g}).finally(()=>{s.disabled=!1,s.textContent=f})})}
