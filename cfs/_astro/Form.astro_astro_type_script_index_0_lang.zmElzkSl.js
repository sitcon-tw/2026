import{g as h}from"./local-storage.CNRxCPsY.js";const q="https://docs.google.com/forms/d/e/1FAIpQLSftAam5nJJQU925yOzuMoome-XY3MEs7idtbd56eqMDRrPKGw/formResponse",n=document.getElementById("sponsor-form"),r=document.getElementById("submit"),i=document.getElementById("form-message");if(!n||!r||!i)console.warn("Sponsor form elements are missing.");else{let u=function(){const e=h();return e.length===0?"":`感興趣的項目：${e.map(t=>t.quantity&&t.quantity>1?`${t.title} ${t.quantity} 份`:t.title).join("、")}`},c=function(){if(!a)return;const e=u();e?a.value=o.trim()?`${o}

${e}`:e:a.value=o};const m=n.dataset.requiredMessage??"請確認必填欄位",l=n.dataset.leadingEqualMessage??"回答的第一個字不可是=",d=n.dataset.successMessage??"已送出成功！感謝您的填寫",g=n.dataset.errorMessage??"發生錯誤，請稍後再試",f=r.dataset.defaultText??r.textContent??"",y=r.dataset.loadingText??"送出中…",p={organization:"entry.1867519928",department:"entry.363990418",name:"entry.1660888396",contact:"entry.1209239304",message:"entry.65159086"},a=n.querySelector('[name="message"]');let o="";a&&(a.addEventListener("input",()=>{const e=a.value,s=u();s&&e.includes(s)?o=e.replace(`

${s}`,"").replace(s,"").trim():o=e}),c(),window.addEventListener("itemsChange",()=>{c()}));const M=()=>{const e=new FormData(n);if(!e.get("organization")||!e.get("name")||!e.get("contact"))return i.textContent=m,!1;for(const[s,t]of e.entries())if(typeof t=="string"&&t.startsWith("="))return i.textContent=l,!1;return i.textContent="",!0};n.addEventListener("submit",e=>{if(e.preventDefault(),!M())return;r.disabled=!0,r.textContent=y;const s=new FormData;Object.entries(p).forEach(([t,x])=>{const E=n.querySelector(`[name="${t}"]`)?.value??"";s.append(x,E)}),fetch(q,{method:"POST",mode:"no-cors",body:s}).then(()=>{n.reset(),o="",c(),i.textContent=d}).catch(t=>{console.error("Form submit error:",t),i.textContent=g}).finally(()=>{r.disabled=!1,r.textContent=f})})}
