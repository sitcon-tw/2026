import{_ as R}from"./preload-helper.BbGayGA1.js";const s=document.getElementById("session-modal"),O=document.getElementById("modal-overlay"),x=document.getElementById("modal-close"),$=document.getElementById("modal-close-mobile"),H=document.getElementById("share-btn");function w(){if(!s)return;s.classList.add("closing");const t=window.matchMedia("(max-width: 968px)").matches?300:220;setTimeout(()=>{s.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const o=window.lenis;o&&typeof o.start=="function"&&o.start(),document.dispatchEvent(new CustomEvent("closeSessionModal"))},t)}x&&x.addEventListener("click",w);$&&$.addEventListener("click",w);O&&O.addEventListener("click",w);H&&H.addEventListener("click",async()=>{if(navigator.share)try{await navigator.share({title:document.querySelector(".session-title")?.textContent||"",text:document.querySelector(".session-description")?.textContent||"",url:window.location.href})}catch(e){console.log("Error sharing:",e)}else navigator.clipboard.writeText(window.location.href)});const Y="sitcon2026:agendaBookmarks",l=document.getElementById("modal-bookmark-ribbon");function K(){try{const e=localStorage.getItem(Y);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.filter(o=>typeof o=="string")):new Set}catch{return new Set}}document.addEventListener("openSessionModal",(e=>{const t=e.detail||{},o=t.id??"",h=t.type??"",u=t.name??"",c=t.description??"",y=t.venue??"",E=t.startTime??"",d=t.endTime??"",k=t.speakers??[],i=t.tags??[],f=t.slidoLink??"",p=t.slidesLink??"",M=t.notesLink??"",A=t.lang??"zh";s&&s.setAttribute("data-session-id",o),l&&(l.classList.toggle("is-bookmarked",o?K().has(o):!1),l.setAttribute("aria-hidden",l.classList.contains("is-bookmarked")?"false":"true"));const B=s?.querySelector(".session-title");B&&(B.textContent=u);const S=s?.querySelector(".session-description");S&&R(async()=>{const{marked:n}=await import("./marked.esm.7nWwd-IH.js");return{marked:n}},[]).then(({marked:n})=>{S.innerHTML=c?n.parse(c):""}).catch(()=>{S.textContent=c});const P=s?.querySelector(".session-type-badge");if(P){const n={keynote:"Keynote",presentation:"Presentation",undefined:A==="en"?"Undefined":"開放式議程",espresso:"Espresso",sponsored:A==="en"?"Sponsored":"合作議程"};P.textContent=n[h]||""}const _=s?.querySelector(".meta-item:first-child span");if(_){const n=a=>a?new Date(Number(a)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Taipei"}):"";_.textContent=`${n(E)}${d?` - ${n(d)}`:""}`}const q=s?.querySelector(".meta-item:nth-child(2) span");q&&(q.textContent=y);const D=s?.querySelector(".session-meta");let m=s?.querySelector(".session-tags");D&&(i.length>0?(m||(m=document.createElement("div"),m.className="session-tags",D.appendChild(m)),m.innerHTML=i.map((n,a)=>`<span class="session-tag" id="tag-${a}">#${n}</span>`).join("")):m&&(m.innerHTML=""));const v=s?.querySelector(".speaker-info");v&&(k.length>0?(v.innerHTML=k.map(n=>{const a=typeof n=="string"?n:n.name,C=typeof n=="object"?n.avatar:null;return`<div class="speaker-item">
						${C?`<img src="${C}" alt="${a}" class="speaker-avatar" />`:""}
						<span class="speaker-name">${a}</span>
					</div>`}).join(""),v.style.display=""):(v.innerHTML="",v.style.display="none"));const g=s?.querySelector(".session-actions");g&&(g.querySelector("a[href*='slido'], a:first-of-type"),g.querySelectorAll("a")[1],g.querySelectorAll("a")[2],g.querySelectorAll("a").forEach((n,a)=>{a===0&&f?(n.href=f,n.style.display=""):a===0&&(n.style.display="none"),a===1&&M?(n.href=M,n.style.display=""):a===1&&(n.style.display="none"),a===2&&p?(n.href=p,n.style.display=""):a===2&&(n.style.display="none")})),s?.classList.add("active");const b=window.lenis;b&&typeof b.stop=="function"&&b.stop()}));function N(e){try{localStorage.setItem(Y,JSON.stringify(Array.from(e)))}catch{}}const L=document.getElementById("modal-bookmark-area");L&&l&&s&&(L.addEventListener("mouseenter",()=>{s.classList.add("bookmark-area-hovered")}),L.addEventListener("mouseleave",()=>{s.classList.remove("bookmark-area-hovered")}),L.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const t=s.getAttribute("data-session-id")??"";if(!t)return;const o=K();o.has(t)?(o.delete(t),N(o),l.classList.remove("is-bookmarked"),l.setAttribute("aria-hidden","true")):(o.add(t),N(o),l.classList.add("is-bookmarked"),l.setAttribute("aria-hidden","false")),document.dispatchEvent(new CustomEvent("bookmarksChanged",{detail:{sessionId:t}}))}));document.addEventListener("keydown",e=>{e.key==="Escape"&&s?.classList.contains("active")&&w()});const I=document.getElementById("modal-container"),T=document.getElementById("modal-drag-handle"),j=window.matchMedia("(max-width: 968px)"),U=80;let r=null;R(async()=>{const{gsap:e}=await import("./index.CMq3EfTn.js");return{gsap:e}},[]).then(({gsap:e})=>{r=e});function V(){if(!I||!T||!s)return;const e=I,t=T,o=s;let h=0,u=0,c=null,y=!1;function E(i){if(!y||i.pointerId!==c)return;i.preventDefault();const f=i.clientY;u=Math.max(0,f-h),r&&r.set(e,{y:u})}function d(i){if(i.pointerId===c){if(y=!1,document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",d),document.removeEventListener("pointercancel",d),c!=null&&t.releasePointerCapture?.(c),e.classList.remove("dragging"),!r){e.style.transform="";return}if(u>=U){const f=e.getBoundingClientRect().height;r.to(e,{y:f,duration:.25,ease:"power2.in",onComplete:()=>{r?.set(e,{clearProps:"y"}),o.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const p=window.lenis;p&&typeof p.start=="function"&&p.start(),document.dispatchEvent(new CustomEvent("closeSessionModal"))}})}else r.to(e,{y:0,duration:.3,ease:"power2.out",onComplete:()=>r?.set(e,{clearProps:"y"})})}}function k(i){!j.matches||!o.classList.contains("active")||(i.preventDefault(),i.stopPropagation(),h=i.clientY,u=0,c=i.pointerId,y=!0,e.classList.add("dragging"),r&&r.killTweensOf(e),t.setPointerCapture?.(i.pointerId),document.addEventListener("pointermove",E,{passive:!1}),document.addEventListener("pointerup",d,{once:!0}),document.addEventListener("pointercancel",d,{once:!0}))}t.addEventListener("pointerdown",k,{passive:!1})}T&&I&&V();window.openSessionModal=()=>{s&&s.classList.add("active")};
