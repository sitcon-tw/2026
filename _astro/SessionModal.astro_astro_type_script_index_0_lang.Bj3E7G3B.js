import{_ as U}from"./preload-helper.BbGayGA1.js";const n=document.getElementById("session-modal"),x=document.getElementById("modal-overlay"),H=document.getElementById("modal-close"),N=document.getElementById("modal-close-mobile"),E=document.getElementById("share-btn");function w(){if(!n)return;n.classList.add("closing");const t=window.matchMedia("(max-width: 968px)").matches?300:220;setTimeout(()=>{n.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const o=window.lenis;o&&typeof o.start=="function"&&o.start();const l=n.querySelector(".session-content");l&&(l.scrollTop=0),document.dispatchEvent(new CustomEvent("closeSessionModal"))},t)}H&&H.addEventListener("click",w);N&&N.addEventListener("click",w);x&&x.addEventListener("click",w);let C=0;function R(){E&&(E.classList.add("is-success"),C&&window.clearTimeout(C),C=window.setTimeout(()=>{E?.classList.remove("is-success")},2e3))}E&&E.addEventListener("click",async()=>{if(navigator.share)try{await navigator.share({title:document.querySelector(".session-title")?.textContent||"",text:document.querySelector(".session-description")?.textContent||"",url:window.location.href}),R()}catch(e){console.log("Error sharing:",e)}else try{await navigator.clipboard.writeText(window.location.href),R()}catch(e){console.log("Error copying:",e)}});const j="sitcon2026:agendaBookmarks",c=document.getElementById("modal-bookmark-ribbon");function K(){try{const e=localStorage.getItem(j);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.filter(o=>typeof o=="string")):new Set}catch{return new Set}}document.addEventListener("openSessionModal",(e=>{const t=e.detail||{},o=t.id??"",l=t.type??"",f=t.name??"",d=t.description??"",g=t.venue??"",L=t.startTime??"",m=t.endTime??"",S=t.speakers??[],i=t.tags??[],p=t.slidoLink??"",v=t.slidesLink??"",y=t.notesLink??"",M=t.lang??"zh";n&&n.setAttribute("data-session-id",o),c&&(c.classList.toggle("is-bookmarked",o?K().has(o):!1),c.setAttribute("aria-hidden",c.classList.contains("is-bookmarked")?"false":"true"));const q=n?.querySelector(".session-title");q&&(q.textContent=f);const A=n?.querySelector(".session-description");A&&(A.innerHTML=d);const P=n?.querySelector(".session-type-badge");if(P){const s={keynote:"Keynote",presentation:"Presentation",undefined:M==="en"?"Undefined":"開放式議程",espresso:"Espresso",sponsored:M==="en"?"Sponsored":"合作議程"};P.textContent=s[l]||""}const _=n?.querySelector(".meta-item:first-child span");if(_){const s=r=>r?new Date(Number(r)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Taipei"}):"";_.textContent=`${s(L)}${m?` - ${s(m)}`:""}`}const D=n?.querySelector(".meta-item:nth-child(2) span");D&&(D.textContent=g);const $=n?.querySelector(".session-meta");let u=n?.querySelector(".session-tags");$&&(i.length>0?(u||(u=document.createElement("div"),u.className="session-tags",$.appendChild(u)),u.innerHTML=i.map((s,r)=>`<span class="session-tag" id="tag-${r}">#${s}</span>`).join("")):u&&(u.innerHTML=""));const O=n?.querySelector(".session-speaker-detail");O&&(O.innerHTML=S.map(s=>{const r=typeof s=="string"?s:s.name,T=typeof s=="object"?`<img src="${s.avatar}" alt="${r}" onerror="this.onerror=null; this.src='https://sitcon.org/2022/imgs/deafult_avatar.jpg'" />`:null;return`<article>
									${T}
									<div>
										<h2>${T}<span>${r}</span></h2>
										${(s.description||"").replace(/\n/g,"<br />")}
									</div>
								</article>`}).join(""));const h=n?.querySelector(".session-actions");h&&(h.querySelector("a[href*='slido'], a:first-of-type"),h.querySelectorAll("a")[1],h.querySelectorAll("a")[2],h.querySelectorAll("a").forEach((s,r)=>{r===0&&p?(s.href=p,s.style.display=""):r===0&&(s.style.display="none"),r===1&&y?(s.href=y,s.style.display=""):r===1&&(s.style.display="none"),r===2&&v?(s.href=v,s.style.display=""):r===2&&(s.style.display="none")})),n?.classList.add("active");const b=window.lenis;b&&typeof b.stop=="function"&&b.stop()}));function Y(e){try{localStorage.setItem(j,JSON.stringify(Array.from(e)))}catch{}}const k=document.getElementById("modal-bookmark-area");k&&c&&n&&(k.addEventListener("mouseenter",()=>{n.classList.add("bookmark-area-hovered")}),k.addEventListener("mouseleave",()=>{n.classList.remove("bookmark-area-hovered")}),k.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const t=n.getAttribute("data-session-id")??"";if(!t)return;const o=K();o.has(t)?(o.delete(t),Y(o),c.classList.remove("is-bookmarked"),c.setAttribute("aria-hidden","true")):(o.add(t),Y(o),c.classList.add("is-bookmarked"),c.setAttribute("aria-hidden","false")),document.dispatchEvent(new CustomEvent("bookmarksChanged",{detail:{sessionId:t}}))}));document.addEventListener("keydown",e=>{e.key==="Escape"&&n?.classList.contains("active")&&w()});const I=document.getElementById("modal-container"),B=document.getElementById("modal-drag-handle"),G=window.matchMedia("(max-width: 968px)"),J=80;let a=null;U(async()=>{const{gsap:e}=await import("./index.CMq3EfTn.js");return{gsap:e}},[]).then(({gsap:e})=>{a=e});function V(){if(!I||!B||!n)return;const e=I,t=B,o=n;let l=0,f=0,d=null,g=!1;function L(i){if(!g||i.pointerId!==d)return;i.preventDefault();const p=i.clientY;f=Math.max(0,p-l),a&&a.set(e,{y:f})}function m(i){if(i.pointerId===d){if(g=!1,document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",m),document.removeEventListener("pointercancel",m),d!=null&&t.releasePointerCapture?.(d),e.classList.remove("dragging"),!a){e.style.transform="";return}if(f>=J){const p=e.getBoundingClientRect().height,v=o.querySelector(".session-content");v&&(v.scrollTop=0),a.to(e,{y:p,duration:.25,ease:"power2.in",onComplete:()=>{a?.set(e,{clearProps:"y"}),o.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const y=window.lenis;y&&typeof y.start=="function"&&y.start(),document.dispatchEvent(new CustomEvent("closeSessionModal"))}})}else a.to(e,{y:0,duration:.3,ease:"power2.out",onComplete:()=>a?.set(e,{clearProps:"y"})})}}function S(i){!G.matches||!o.classList.contains("active")||(i.preventDefault(),i.stopPropagation(),l=i.clientY,f=0,d=i.pointerId,g=!0,e.classList.add("dragging"),a&&a.killTweensOf(e),t.setPointerCapture?.(i.pointerId),document.addEventListener("pointermove",L,{passive:!1}),document.addEventListener("pointerup",m,{once:!0}),document.addEventListener("pointercancel",m,{once:!0}))}t.addEventListener("pointerdown",S,{passive:!1})}B&&I&&V();window.openSessionModal=()=>{n&&n.classList.add("active")};
