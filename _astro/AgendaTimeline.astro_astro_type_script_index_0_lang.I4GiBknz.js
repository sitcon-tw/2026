import{gsap as se}from"./index.CMq3EfTn.js";const n=document.getElementById("agenda-scroll"),X=document.getElementById("scroll-left"),J=document.getElementById("scroll-right"),U=document.getElementById("zoom-in"),Y=document.getElementById("zoom-out"),E=document.getElementById("current-time-indicator"),p=document.getElementById("current-time-line"),Z=document.getElementById("agenda-timeline-inner");(!n||!X||!J)&&console.warn("Agenda timeline elements not found");if(Z&&U&&Y){let e=2;const i=0,o=5,t=.25,a=()=>{Z.style.setProperty("--time-scale",e.toString())};a(),U.addEventListener("click",()=>{e=Math.min(o,e+t),a()}),Y.addEventListener("click",()=>{e=Math.max(i,e-t),a()})}if(n&&X&&J){X.addEventListener("click",()=>{n.scrollBy({left:-300,behavior:"smooth"})}),J.addEventListener("click",()=>{n.scrollBy({left:300,behavior:"smooth"})});let i=!1,o=0,t=0,a=0,L=0,f=0,l=null;const S=s=>{const c=s.target;if(!c||document.getElementById("session-modal")?.classList.contains("active")||c.closest(".venue-label")||c.tagName==="BUTTON"||c.tagName==="A"||c.closest("button")||c.closest("a"))return;l&&(l.kill(),l=null),i=!0;const r="touches"in s?s.touches[0].clientX:s.clientX;o=r,t=n.scrollLeft,a=r,L=Date.now(),f=0,n.style.cursor="grabbing",n.style.userSelect="none",s.preventDefault()},m=s=>{if(!i)return;if(document.getElementById("session-modal")?.classList.contains("active")){h();return}const u="touches"in s?s.touches[0].clientX:s.clientX,g=Date.now(),r=u-o,w=g-L;w>0&&(f=(u-a)/w),n.scrollLeft=t-r,a=u,L=g,s.preventDefault()},h=()=>{if(i&&(i=!1,n.style.cursor="grab",n.style.userSelect="",Math.abs(f)>.01)){const s=n.scrollWidth-n.clientWidth,c=n.scrollLeft,u=-f*1e3,g=c+u*.5,r=Math.max(0,Math.min(s,g));l=se.to(n,{scrollLeft:r,duration:Math.min(2,Math.abs(f)*10),ease:"power2.out",onUpdate:()=>{n.scrollLeft<0?(n.scrollLeft=0,l&&(l.kill(),l=null)):n.scrollLeft>s&&(n.scrollLeft=s,l&&(l.kill(),l=null))},onComplete:()=>{l=null}})}};n.addEventListener("mousedown",S),document.addEventListener("mousemove",m),document.addEventListener("mouseup",h),n.addEventListener("touchstart",S,{passive:!1}),n.addEventListener("touchmove",m,{passive:!1}),n.addEventListener("touchend",h),n.addEventListener("wheel",s=>{if(document.getElementById("session-modal")?.classList.contains("active"))return;const u=s.deltaX||0,g=s.deltaY||0;Math.abs(u)>Math.abs(g)?u!==0&&(s.preventDefault(),n.scrollBy({left:u,behavior:"auto"})):g!==0&&s.shiftKey&&(s.preventDefault(),n.scrollBy({left:g,behavior:"auto"}))},{passive:!1});const v=document.getElementById("agenda-timeline-inner"),N=v?.dataset.minTime,y=v?.dataset.maxTime,R=v?.dataset.totalSlots,z=v?.dataset.timeLabels,F=v?.dataset.slotLeftPercents,V=v?.dataset.slotWeights,K=v?.dataset.totalWeight;if(v&&E&&p&&N&&y&&R&&z&&F&&V&&K){const s=parseInt(N,10),c=parseInt(y,10),u=parseInt(R,10),g=parseFloat(K);let r=[],w=[],P=[];try{r=JSON.parse(z),w=JSON.parse(F),P=JSON.parse(V)}catch{r=[],w=[],P=[]}const ne=I=>{if(u<=0||r.length<2)return 0;for(let b=0;b<r.length-1;b++){const T=r[b],x=r[b+1];if(I>=T&&I<=x){const B=x-T,C=B>0?(I-T)/B:0,k=P[b]/g*100;return w[b]+C*k}}return I<r[0]?0:100};if(!isNaN(s)&&!isNaN(c)&&r.length>=2){const I=Date.now();if(I<s||I>c)E.parentNode&&E.parentNode.removeChild(E),p.parentNode&&p.parentNode.removeChild(p);else{let b=!1;const T=p||E;if(T&&!b){const B=T.offsetLeft,C=n.clientWidth,k=B-C/2;n.scrollTo({left:Math.max(0,k),behavior:"smooth"}),b=!0}const x=()=>{const B=Date.now();if(B>=s&&B<=c){const k=`${ne(B)}%`;E.style.left=k,p.style.left=k}else E.parentNode&&E.parentNode.removeChild(E),p.parentNode&&p.parentNode.removeChild(p)};x(),setInterval(x,1e3)}}}}const M=document.getElementById("agenda-timeline"),Q=[{list:document.getElementById("filter-tabs-list"),slider:document.getElementById("filter-tab-slider")},{list:document.getElementById("filter-tabs-list-mobile"),slider:document.getElementById("filter-tab-slider-mobile")}].filter(e=>!!e.list&&!!e.slider),W=document.querySelectorAll(".filter-tab");function D(){Q.forEach(({list:e,slider:i})=>{const o=e.querySelector(".filter-tab.active, .filter-tab[aria-selected='true']");if(!o)return;const t=e.getBoundingClientRect(),a=o.getBoundingClientRect();i.style.left=`${a.left-t.left}px`,i.style.width=`${a.width}px`})}W.forEach(e=>{e.addEventListener("click",()=>{const i=e.dataset.filter;if(!i)return;if(i==="all"&&M?.classList.contains("agenda-url-curated")){document.dispatchEvent(new CustomEvent("clearUrlCuratedState")),D();return}const o=Array.from(W).filter(t=>t!==e&&t.dataset.filter===i);W.forEach(t=>{t.setAttribute("aria-selected","false"),t.classList.remove("active")}),e.setAttribute("aria-selected","true"),e.classList.add("active"),o.forEach(t=>{t.setAttribute("aria-selected","true"),t.classList.add("active")}),M&&(i==="favorites"?M.classList.add("agenda-filter-favorites"):M.classList.remove("agenda-filter-favorites")),D(),O()})});function O(){const e=document.getElementById("agenda-timeline"),i=document.getElementById("agenda-phone-view");if(!e||!i)return;const o=e.classList.contains("agenda-filter-favorites")&&!e.classList.contains("agenda-url-curated");i.querySelectorAll(".time-block").forEach(a=>{const L=a.querySelectorAll(".session-block"),f=L.length>0&&Array.from(L).every(l=>!l.querySelector(".session-favorite.is-marked"));o&&f?a.classList.add("time-block-no-visible-sessions"):a.classList.remove("time-block-no-visible-sessions")})}requestAnimationFrame(()=>{D(),O()});document.addEventListener("agendaBookmarksChanged",()=>{O()});Q.length>0&&window.addEventListener("resize",D);const A=document.getElementById("share-jam-trigger"),d=document.getElementById("share-jam-trigger-mobile"),ie="sitcon2026:agendaBookmarks";let q=!1;function ee(){try{const e=localStorage.getItem(ie),i=e?JSON.parse(e):[],o=Array.isArray(i)&&i.length>0;A&&(A.style.display=o?"":"none");const t=document.getElementById("agenda-mobile-controls");d&&(o&&!q?(d.classList.remove("hidden"),d.classList.add("slide-in","glowing"),t?.classList.add("share-button-visible"),t?.classList.remove("share-button-hidden"),setTimeout(()=>{d.classList.remove("glowing")},2e3)):!o&&q?(d.classList.remove("slide-in","glowing"),d.classList.add("hidden"),t?.classList.add("share-button-hidden"),t?.classList.remove("share-button-visible")):o?(d.classList.remove("hidden"),d.classList.add("slide-in"),t?.classList.add("share-button-visible"),t?.classList.remove("share-button-hidden")):(d.classList.add("hidden"),d.classList.remove("slide-in","glowing"),t?.classList.add("share-button-hidden"),t?.classList.remove("share-button-visible"))),q=o}catch{A&&(A.style.display="none"),d&&(d.classList.add("hidden"),document.getElementById("agenda-mobile-controls")?.classList.add("share-button-hidden"),document.getElementById("agenda-mobile-controls")?.classList.remove("share-button-visible"))}}A&&A.addEventListener("click",()=>{window.openShareJamModal?.()});d&&d.addEventListener("click",()=>{window.openShareJamModal?.()});ee();document.addEventListener("agendaBookmarksChanged",ee);function $(){const e=document.getElementById("agenda-phone-view");if(!e||window.matchMedia("(min-width: 769px)").matches)return;const i=document.getElementById("agenda-timeline-inner"),o=i?.getAttribute("data-min-time"),t=i?.getAttribute("data-max-time"),a=o!=null?parseInt(o,10):NaN,L=t!=null?parseInt(t,10):NaN,f=Date.now();if(isNaN(a)||isNaN(L)||f<a||f>L){e.querySelectorAll(".time-block.current").forEach(m=>{m.classList.remove("current"),m.querySelector(".phone-time-indicator")?.remove()});return}const l=e.querySelectorAll(".time-block");let S=null;l.forEach(m=>{const h=parseInt(m.dataset.time??"",10);!isNaN(h)&&h<=f&&(S=S==null?h:Math.max(S,h))}),l.forEach(m=>{const h=parseInt(m.dataset.time??"",10),v=S!=null&&h===S,N=m.querySelector(".time-block-label");let y=m.querySelector(".phone-time-indicator");v?(m.classList.add("current"),!y&&N&&(y=document.createElement("span"),y.className="phone-time-indicator",y.setAttribute("aria-hidden","true"),N.insertBefore(y,N.firstChild))):(m.classList.remove("current"),y?.remove())})}const oe=document.getElementById("agenda-phone-view"),te=document.getElementById("agenda-timeline-inner"),j=te?.getAttribute("data-min-time"),H=te?.getAttribute("data-max-time"),_=j!=null?parseInt(j,10):NaN,G=H!=null?parseInt(H,10):NaN,ae=!isNaN(_)&&!isNaN(G)&&Date.now()>=_&&Date.now()<=G;oe&&ae&&($(),setInterval($,60*1e3));
