import{gsap as se}from"./index.CMq3EfTn.js";const n=document.getElementById("agenda-scroll"),X=document.getElementById("scroll-left"),J=document.getElementById("scroll-right"),U=document.getElementById("zoom-in"),Y=document.getElementById("zoom-out"),E=document.getElementById("current-time-indicator"),S=document.getElementById("current-time-line"),Z=document.getElementById("agenda-timeline-inner");(!n||!X||!J)&&console.warn("Agenda timeline elements not found");if(Z&&U&&Y){let t=2;const o=0,s=5,e=.25,r=()=>{Z.style.setProperty("--time-scale",t.toString())};r(),U.addEventListener("click",()=>{t=Math.min(s,t+e),r()}),Y.addEventListener("click",()=>{t=Math.max(o,t-e),r()})}if(n&&X&&J){X.addEventListener("click",()=>{n.scrollBy({left:-300,behavior:"smooth"})}),J.addEventListener("click",()=>{n.scrollBy({left:300,behavior:"smooth"})});let o=!1,s=0,e=0,r=0,y=0,u=0,a=null;const h=i=>{const d=i.target;if(!d||document.getElementById("session-modal")?.classList.contains("active")||d.closest(".venue-label")||d.tagName==="BUTTON"||d.tagName==="A"||d.closest("button")||d.closest("a"))return;a&&(a.kill(),a=null),o=!0;const c="touches"in i?i.touches[0].clientX:i.clientX;s=c,e=n.scrollLeft,r=c,y=Date.now(),u=0,n.style.cursor="grabbing",n.style.userSelect="none",i.preventDefault()},l=i=>{if(!o)return;if(document.getElementById("session-modal")?.classList.contains("active")){v();return}const f="touches"in i?i.touches[0].clientX:i.clientX,g=Date.now(),c=f-s,w=g-y;w>0&&(u=(f-r)/w),n.scrollLeft=e-c,r=f,y=g,i.preventDefault()},v=()=>{if(o&&(o=!1,n.style.cursor="grab",n.style.userSelect="",Math.abs(u)>.01)){const i=n.scrollWidth-n.clientWidth,d=n.scrollLeft,f=-u*1e3,g=d+f*.5,c=Math.max(0,Math.min(i,g));a=se.to(n,{scrollLeft:c,duration:Math.min(2,Math.abs(u)*10),ease:"power2.out",onUpdate:()=>{n.scrollLeft<0?(n.scrollLeft=0,a&&(a.kill(),a=null)):n.scrollLeft>i&&(n.scrollLeft=i,a&&(a.kill(),a=null))},onComplete:()=>{a=null}})}};n.addEventListener("mousedown",h),document.addEventListener("mousemove",l),document.addEventListener("mouseup",v),n.addEventListener("touchstart",h,{passive:!1}),n.addEventListener("touchmove",l,{passive:!1}),n.addEventListener("touchend",v),n.addEventListener("wheel",i=>{if(document.getElementById("session-modal")?.classList.contains("active"))return;const f=i.deltaX||0,g=i.deltaY||0;Math.abs(f)>Math.abs(g)?f!==0&&(i.preventDefault(),n.scrollBy({left:f,behavior:"auto"})):g!==0&&i.shiftKey&&(i.preventDefault(),n.scrollBy({left:g,behavior:"auto"}))},{passive:!1});const L=document.getElementById("agenda-timeline-inner"),N=L?.dataset.minTime,b=L?.dataset.maxTime,R=L?.dataset.totalSlots,F=L?.dataset.timeLabels,z=L?.dataset.slotLeftPercents,V=L?.dataset.slotWeights,K=L?.dataset.totalWeight;if(L&&E&&S&&N&&b&&R&&F&&z&&V&&K){const i=parseInt(N,10),d=parseInt(b,10),f=parseInt(R,10),g=parseFloat(K);let c=[],w=[],P=[];try{c=JSON.parse(F),w=JSON.parse(z),P=JSON.parse(V)}catch{c=[],w=[],P=[]}const ne=I=>{if(f<=0||c.length<2)return 0;for(let p=0;p<c.length-1;p++){const T=c[p],x=c[p+1];if(I>=T&&I<=x){const B=x-T,C=B>0?(I-T)/B:0,A=P[p]/g*100;return w[p]+C*A}}return I<c[0]?0:100};if(!isNaN(i)&&!isNaN(d)&&c.length>=2){const I=Date.now();if(I<i||I>d)E.parentNode&&E.parentNode.removeChild(E),S.parentNode&&S.parentNode.removeChild(S);else{let p=!1;const T=S||E;if(T&&!p){const B=T.offsetLeft,C=n.clientWidth,A=B-C/2;n.scrollTo({left:Math.max(0,A),behavior:"smooth"}),p=!0}const x=()=>{const B=Date.now();if(B>=i&&B<=d){const A=`${ne(B)}%`;E.style.left=A,S.style.left=A}else E.parentNode&&E.parentNode.removeChild(E),S.parentNode&&S.parentNode.removeChild(S)};x(),setInterval(x,1e3)}}}}const M=document.getElementById("agenda-timeline"),Q=[{list:document.getElementById("filter-tabs-list"),slider:document.getElementById("filter-tab-slider")},{list:document.getElementById("filter-tabs-list-mobile"),slider:document.getElementById("filter-tab-slider-mobile")}].filter(t=>!!t.list&&!!t.slider),q=document.querySelectorAll(".filter-tab");function D(){Q.forEach(({list:t,slider:o})=>{const s=t.querySelector(".filter-tab.active, .filter-tab[aria-selected='true']");if(!s)return;const e=t.getBoundingClientRect(),r=s.getBoundingClientRect();o.style.left=`${r.left-e.left}px`,o.style.width=`${r.width}px`})}q.forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.filter;if(!o)return;if(o==="all"&&M?.classList.contains("agenda-url-curated")){document.dispatchEvent(new CustomEvent("clearUrlCuratedState")),D();return}const s=Array.from(q).filter(e=>e!==t&&e.dataset.filter===o);q.forEach(e=>{e.setAttribute("aria-selected","false"),e.classList.remove("active")}),t.setAttribute("aria-selected","true"),t.classList.add("active"),s.forEach(e=>{e.setAttribute("aria-selected","true"),e.classList.add("active")}),M&&(o==="favorites"?M.classList.add("agenda-filter-favorites"):M.classList.remove("agenda-filter-favorites")),D(),O()})});function O(){const t=document.getElementById("agenda-timeline"),o=document.getElementById("agenda-phone-view"),s=document.getElementById("agenda-phone-empty-favorites");if(!t||!o)return;const e=t.classList.contains("agenda-filter-favorites")&&!t.classList.contains("agenda-url-curated"),r=o.querySelectorAll(".time-block");let y=!1;r.forEach(u=>{const a=u.querySelectorAll(".session-block"),h=a.length>0&&Array.from(a).every(l=>!l.querySelector(".session-favorite.is-marked"));Array.from(a).some(l=>l.querySelector(".session-favorite.is-marked"))&&(y=!0),e&&h?u.classList.add("time-block-no-visible-sessions"):u.classList.remove("time-block-no-visible-sessions")}),s&&(e&&!y?(s.removeAttribute("hidden"),s.classList.add("agenda-phone-empty-favorites-visible")):(s.setAttribute("hidden",""),s.classList.remove("agenda-phone-empty-favorites-visible")))}requestAnimationFrame(()=>{D(),O()});document.addEventListener("agendaBookmarksChanged",()=>{O()});Q.length>0&&window.addEventListener("resize",D);const k=document.getElementById("share-jam-trigger"),m=document.getElementById("share-jam-trigger-mobile"),ie="sitcon2026:agendaBookmarks";let W=!1;function ee(){try{const t=localStorage.getItem(ie),o=t?JSON.parse(t):[],s=Array.isArray(o)&&o.length>0;k&&(k.style.display=s?"":"none");const e=document.getElementById("agenda-mobile-controls");m&&(s&&!W?(m.classList.remove("hidden"),m.classList.add("slide-in","glowing"),e?.classList.add("share-button-visible"),e?.classList.remove("share-button-hidden"),setTimeout(()=>{m.classList.remove("glowing")},2e3)):!s&&W?(m.classList.remove("slide-in","glowing"),m.classList.add("hidden"),e?.classList.add("share-button-hidden"),e?.classList.remove("share-button-visible")):s?(m.classList.remove("hidden"),m.classList.add("slide-in"),e?.classList.add("share-button-visible"),e?.classList.remove("share-button-hidden")):(m.classList.add("hidden"),m.classList.remove("slide-in","glowing"),e?.classList.add("share-button-hidden"),e?.classList.remove("share-button-visible"))),W=s}catch{k&&(k.style.display="none"),m&&(m.classList.add("hidden"),document.getElementById("agenda-mobile-controls")?.classList.add("share-button-hidden"),document.getElementById("agenda-mobile-controls")?.classList.remove("share-button-visible"))}}k&&k.addEventListener("click",()=>{window.openShareJamModal?.()});m&&m.addEventListener("click",()=>{window.openShareJamModal?.()});ee();document.addEventListener("agendaBookmarksChanged",ee);function $(){const t=document.getElementById("agenda-phone-view");if(!t||window.matchMedia("(min-width: 769px)").matches)return;const o=document.getElementById("agenda-timeline-inner"),s=o?.getAttribute("data-min-time"),e=o?.getAttribute("data-max-time"),r=s!=null?parseInt(s,10):NaN,y=e!=null?parseInt(e,10):NaN,u=Date.now();if(isNaN(r)||isNaN(y)||u<r||u>y){t.querySelectorAll(".time-block.current").forEach(l=>{l.classList.remove("current"),l.querySelector(".phone-time-indicator")?.remove()});return}const a=t.querySelectorAll(".time-block");let h=null;a.forEach(l=>{const v=parseInt(l.dataset.time??"",10);!isNaN(v)&&v<=u&&(h=h==null?v:Math.max(h,v))}),a.forEach(l=>{const v=parseInt(l.dataset.time??"",10),L=h!=null&&v===h,N=l.querySelector(".time-block-label");let b=l.querySelector(".phone-time-indicator");L?(l.classList.add("current"),!b&&N&&(b=document.createElement("span"),b.className="phone-time-indicator",b.setAttribute("aria-hidden","true"),N.insertBefore(b,N.firstChild))):(l.classList.remove("current"),b?.remove())})}const oe=document.getElementById("agenda-phone-view"),te=document.getElementById("agenda-timeline-inner"),j=te?.getAttribute("data-min-time"),H=te?.getAttribute("data-max-time"),_=j!=null?parseInt(j,10):NaN,G=H!=null?parseInt(H,10):NaN,ae=!isNaN(_)&&!isNaN(G)&&Date.now()>=_&&Date.now()<=G;oe&&ae&&($(),setInterval($,60*1e3));
