import{_ as U}from"./preload-helper.BbGayGA1.js";const n=document.getElementById("session-modal"),N=document.getElementById("modal-overlay"),R=document.getElementById("modal-close"),j=document.getElementById("modal-close-mobile"),S=document.getElementById("share-btn");function C(){if(!n)return;n.classList.add("closing");const t=window.matchMedia("(max-width: 968px)").matches?300:220;setTimeout(()=>{n.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const i=window.lenis;i&&typeof i.start=="function"&&i.start();const d=n.querySelector(".session-content");d&&(d.scrollTop=0),document.dispatchEvent(new CustomEvent("closeSessionModal"))},t)}R&&R.addEventListener("click",C);j&&j.addEventListener("click",C);N&&N.addEventListener("click",C);let A=0;function Y(){S&&(S.classList.add("is-success"),A&&window.clearTimeout(A),A=window.setTimeout(()=>{S?.classList.remove("is-success")},2e3))}S&&S.addEventListener("click",async()=>{if(navigator.share)try{await navigator.share({title:document.querySelector(".session-title")?.textContent||"",text:document.querySelector(".session-description")?.textContent||"",url:window.location.href}),Y()}catch(e){console.log("Error sharing:",e)}else try{await navigator.clipboard.writeText(window.location.href),Y()}catch(e){console.log("Error copying:",e)}});const V="sitcon2026:agendaBookmarks",l=document.getElementById("modal-bookmark-ribbon");function G(){try{const e=localStorage.getItem(V);if(!e)return new Set;const t=JSON.parse(e);return Array.isArray(t)?new Set(t.filter(i=>typeof i=="string")):new Set}catch{return new Set}}document.addEventListener("openSessionModal",(e=>{const t=e.detail||{},i=t.id??"",d=t.type??"",y=t.name??"",c=t.description??"",E=t.venue??"",b=t.startTime??"",m=t.endTime??"",k=t.speakers??[],a=t.tags??[],g=t.slidoLink??"",L=t.slidesLink??"",h=t.notesLink??"",_=t.lang??"zh";n&&n.setAttribute("data-session-id",i),l&&(l.classList.toggle("is-bookmarked",i?G().has(i):!1),l.setAttribute("aria-hidden",l.classList.contains("is-bookmarked")?"false":"true"));const $=n?.querySelector(".session-title");$&&($.textContent=y);const I=n?.querySelector(".session-description");I&&U(async()=>{const{marked:o}=await import("./marked.esm.7nWwd-IH.js");return{marked:o}},[]).then(({marked:o})=>{I.innerHTML=c?o.parse(c):""}).catch(()=>{I.textContent=c});const q=n?.querySelector(".session-type-badge");if(q){const o={keynote:"Keynote",presentation:"Presentation",undefined:_==="en"?"Undefined":"開放式議程",espresso:"Espresso",sponsored:_==="en"?"Sponsored":"合作議程"};q.textContent=o[d]||""}const D=n?.querySelector(".meta-item:first-child span");if(D){const o=s=>s?new Date(Number(s)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Taipei"}):"";D.textContent=`${o(b)}${m?` - ${o(m)}`:""}`}const O=n?.querySelector(".meta-item:nth-child(2) span");O&&(O.textContent=E);const x=n?.querySelector(".session-meta");let u=n?.querySelector(".session-tags");x&&(a.length>0?(u||(u=document.createElement("div"),u.className="session-tags",x.appendChild(u)),u.innerHTML=a.map((o,s)=>`<span class="session-tag" id="tag-${s}">#${o}</span>`).join("")):u&&(u.innerHTML=""));const p=n?.querySelector(".session-speaker-detail");if(p)if(k.length>0){k.map(s=>{const f=typeof s=="string"?s:s.name,v=typeof s=="object"?s.avatar:null;return`<div class="speaker-item">
							${v?`<img src="${v}" alt="${f}" class="speaker-avatar" />`:""}
							<span class="speaker-name">${f}</span>
						</div>`}).join("");const o=k.map(s=>{const f=typeof s=="string"?s:s.name,v=typeof s=="object"?s.avatar:null,H=typeof s=="object"&&s.description||"",J=H?`<p class="speaker-detail-bio">${H.replace(/\n/g,"<br />")}</p>`:"";return`<article class="speaker-detail-card">
							<div class="speaker-detail-header">
								<h2 class="speaker-detail-name">
									${f}
								</h2>
								${v?`<div class="speaker-detail-avatar-wrapper-mobile">
									<div class="speaker-detail-avatar-frame">
										<img src="${v}" alt="${f}" class="speaker-detail-avatar" />
									</div>
								</div>`:""}
							</div>

							<div class="speaker-detail-text">
								${v?`<div class="speaker-detail-avatar-wrapper">
									<div class="speaker-detail-avatar-frame">
										<img src="${v}" alt="${f}" class="speaker-detail-avatar" />
									</div>
								</div>`:""}
								${J}
							</div>
						</article>`}).join("");p&&(p.innerHTML=o,p.style.display="")}else p&&(p.innerHTML="",p.style.display="none");const w=n?.querySelector(".session-actions");w&&(w.querySelector("a[href*='slido'], a:first-of-type"),w.querySelectorAll("a")[1],w.querySelectorAll("a")[2],w.querySelectorAll("a").forEach((o,s)=>{s===0&&g?(o.href=g,o.style.display=""):s===0&&(o.style.display="none"),s===1&&h?(o.href=h,o.style.display=""):s===1&&(o.style.display="none"),s===2&&L?(o.href=L,o.style.display=""):s===2&&(o.style.display="none")})),n?.classList.add("active");const M=window.lenis;M&&typeof M.stop=="function"&&M.stop()}));function K(e){try{localStorage.setItem(V,JSON.stringify(Array.from(e)))}catch{}}const T=document.getElementById("modal-bookmark-area");T&&l&&n&&(T.addEventListener("mouseenter",()=>{n.classList.add("bookmark-area-hovered")}),T.addEventListener("mouseleave",()=>{n.classList.remove("bookmark-area-hovered")}),T.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const t=n.getAttribute("data-session-id")??"";if(!t)return;const i=G();i.has(t)?(i.delete(t),K(i),l.classList.remove("is-bookmarked"),l.setAttribute("aria-hidden","true")):(i.add(t),K(i),l.classList.add("is-bookmarked"),l.setAttribute("aria-hidden","false")),document.dispatchEvent(new CustomEvent("bookmarksChanged",{detail:{sessionId:t}}))}));document.addEventListener("keydown",e=>{e.key==="Escape"&&n?.classList.contains("active")&&C()});const B=document.getElementById("modal-container"),P=document.getElementById("modal-drag-handle"),z=window.matchMedia("(max-width: 968px)"),Q=80;let r=null;U(async()=>{const{gsap:e}=await import("./index.CMq3EfTn.js");return{gsap:e}},[]).then(({gsap:e})=>{r=e});function Z(){if(!B||!P||!n)return;const e=B,t=P,i=n;let d=0,y=0,c=null,E=!1;function b(a){if(!E||a.pointerId!==c)return;a.preventDefault();const g=a.clientY;y=Math.max(0,g-d),r&&r.set(e,{y})}function m(a){if(a.pointerId===c){if(E=!1,document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",m),document.removeEventListener("pointercancel",m),c!=null&&t.releasePointerCapture?.(c),e.classList.remove("dragging"),!r){e.style.transform="";return}if(y>=Q){const g=e.getBoundingClientRect().height,L=i.querySelector(".session-content");L&&(L.scrollTop=0),r.to(e,{y:g,duration:.25,ease:"power2.in",onComplete:()=>{r?.set(e,{clearProps:"y"}),i.classList.remove("active","closing","bookmark-area-hovered"),document.body.style.overflow="";const h=window.lenis;h&&typeof h.start=="function"&&h.start(),document.dispatchEvent(new CustomEvent("closeSessionModal"))}})}else r.to(e,{y:0,duration:.3,ease:"power2.out",onComplete:()=>r?.set(e,{clearProps:"y"})})}}function k(a){!z.matches||!i.classList.contains("active")||(a.preventDefault(),a.stopPropagation(),d=a.clientY,y=0,c=a.pointerId,E=!0,e.classList.add("dragging"),r&&r.killTweensOf(e),t.setPointerCapture?.(a.pointerId),document.addEventListener("pointermove",b,{passive:!1}),document.addEventListener("pointerup",m,{once:!0}),document.addEventListener("pointercancel",m,{once:!0}))}t.addEventListener("pointerdown",k,{passive:!1})}P&&B&&Z();window.openSessionModal=()=>{n&&n.classList.add("active")};
